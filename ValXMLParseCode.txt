import re

# Convert recordOrganisations to string, just to be safe
df_TradeAccounts['recordOrganisations'] = df_TradeAccounts['recordOrganisations'].astype(str)

# Precompile two simple regexes:
#   e.g. `'longName':'NOMURA NEW YORK (SALES OFFICE)'`
pattern_long = re.compile(r"'longName'\s*:\s*'NOMURA\s+([^']+)\s*\(SALES OFFICE\)'")
pattern_full = re.compile(r"'fullName'\s*:\s*'NOMURA\s+([^']+)\s*\(SALES OFFICE\)'")

def parse_city(pattern, text):
    match = pattern.search(text)
    return match.group(1).strip() if match else None

df_TradeAccounts['recordOrganisation longName'] = df_TradeAccounts['recordOrganisations'].apply(
    lambda x: parse_city(pattern_long, x)
)
df_TradeAccounts['recordOrganisation fullName'] = df_TradeAccounts['recordOrganisations'].apply(
    lambda x: parse_city(pattern_full, x)
)

Alteryx.write(df_TradeAccounts, 1)
