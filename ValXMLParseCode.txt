import re

def parse_sella(xml_str, field_name):
    if not re.search(r"'organisationRole'\s*:\s*'SELLA'", xml_str):
        return None
    pattern = fr"'{field_name}'\s*:\s*'([^']*)'"
    m = re.search(pattern, xml_str)
    if not m:
        return None
    sub = re.search(r"NOMURA\s+(.*?)\s*\(SALES OFFICE\)", m.group(1))
    return sub.group(1).strip() if sub else None

df_TradeAccounts['recordOrganisation longName'] = df_TradeAccounts['recordOrganisations'].apply(
    lambda x: parse_sella(x, 'longName')
)
df_TradeAccounts['recordOrganisation fullName'] = df_TradeAccounts['recordOrganisations'].apply(
    lambda x: parse_sella(x, 'fullName')
)

Alteryx.write(df_TradeAccounts, 1)
